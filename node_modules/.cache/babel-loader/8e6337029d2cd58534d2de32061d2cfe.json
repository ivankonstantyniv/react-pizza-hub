{"ast":null,"code":"import _toConsumableArray from\"C:/Users/bigba/Desktop/reactjs_projects/react-pizza/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/bigba/Desktop/reactjs_projects/react-pizza/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/bigba/Desktop/reactjs_projects/react-pizza/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/bigba/Desktop/reactjs_projects/react-pizza/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';// libs\nimport uniqid from'uniqid';import{useSelector}from'react-redux';import{useNavigate}from'react-router-dom';// components\nimport Categories from'../components/Categories';import Sort from'../components/Sort';import PizzaBlock from'../components/PizzaBlock';import Skeleton from'../components/PizzaBlock/Skeleton';import Pagination from'../components/Pagination';import ErrorGetItems from'../components/ErrorGetItems';// redux slices\nimport{fetchItems,selectItemsList}from'../redux/slices/itemsSlice';import{useAppDispatch}from'../redux/store';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Home=function Home(){var navigate=useNavigate();var dispatch=useAppDispatch();var isSearchUrl=React.useRef(false);var isFirstMounted=React.useRef(false);var _useSelector=useSelector(function(state){return state.filter;}),categoryValue=_useSelector.categoryValue,sortValue=_useSelector.sortValue,searchValue=_useSelector.searchValue,currentPage=_useSelector.currentPage;var _useSelector2=useSelector(selectItemsList),itemsList=_useSelector2.itemsList,status=_useSelector2.status;var fetching=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var sortValues,category,sort,search,filters;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sortValues=['rating','price&order=asc','price&order=desc','name&order=asc','name&order=desc'];category=categoryValue===0?'':\"&category=\".concat(categoryValue);sort=\"&sortBy=\".concat(sortValues[sortValue]);search=searchValue?\"&search=\".concat(searchValue):'';filters=sort+category+search;dispatch(fetchItems({filters:filters,currentPage:currentPage}));case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetching(){return _ref.apply(this,arguments);};}();React.useEffect(function(){window.scrollTo(0,0);fetching();isSearchUrl.current=false;},[categoryValue,sortValue,searchValue,currentPage,window.location.search]);// React.useEffect(() => {\n//   if (window.location.search) {\n//     const params = (qs.parse(window.location.search.substring(1)) as unknown) as FilterSliceType;\n//     dispatch(setFilters({ ...params }));\n//     isSearchUrl.current = true;\n//   }\n// }, []);\n// React.useEffect(() => {\n//   if (isFirstMounted.current) {\n//     const queryString: string = qs.stringify({\n//       categoryValue,\n//       sortValue,\n//       currentPage,\n//     });\n//     navigate(`?${queryString}`);\n//   } else {\n//     navigate('/');\n//     isFirstMounted.current = true;\n//   }\n// }, [categoryValue, sortValue, currentPage]);\nvar pizzas=itemsList.map(function(obj){return/*#__PURE__*/_jsx(PizzaBlock,_objectSpread({},obj),obj.id);});var skeleton=_toConsumableArray(Array(4)).map(function(){return/*#__PURE__*/_jsx(Skeleton,{},uniqid());});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content__top\",children:[/*#__PURE__*/_jsx(Categories,{}),/*#__PURE__*/_jsx(Sort,{value:sortValue})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"content__title\",children:\"\\u0423\\u0441\\u0456 \\u043F\\u0456\\u0446\\u0438\"}),status==='error'?/*#__PURE__*/_jsx(ErrorGetItems,{}):/*#__PURE__*/_jsx(\"div\",{className:\"content__items\",children:status!=='success'?skeleton:pizzas}),itemsList.length>0&&/*#__PURE__*/_jsx(Pagination,{})]});};export default Home;","map":{"version":3,"names":["React","uniqid","useSelector","useNavigate","Categories","Sort","PizzaBlock","Skeleton","Pagination","ErrorGetItems","fetchItems","selectItemsList","useAppDispatch","Home","navigate","dispatch","isSearchUrl","useRef","isFirstMounted","state","filter","categoryValue","sortValue","searchValue","currentPage","itemsList","status","fetching","sortValues","category","sort","search","filters","useEffect","window","scrollTo","current","location","pizzas","map","obj","id","skeleton","Array","length"],"sources":["C:/Users/bigba/Desktop/reactjs_projects/react-pizza/src/pages/Home.tsx"],"sourcesContent":["import React from 'react';\r\n// libs\r\nimport uniqid from 'uniqid';\r\nimport { useSelector } from 'react-redux';\r\nimport qs from 'qs';\r\nimport { useNavigate } from 'react-router-dom';\r\n// components\r\nimport Categories from '../components/Categories';\r\nimport Sort from '../components/Sort';\r\nimport PizzaBlock from '../components/PizzaBlock';\r\nimport Skeleton from '../components/PizzaBlock/Skeleton';\r\nimport Pagination from '../components/Pagination';\r\nimport ErrorGetItems from '../components/ErrorGetItems';\r\n// redux slices\r\nimport { fetchItems, selectItemsList } from '../redux/slices/itemsSlice';\r\nimport { FilterSliceType, setFilters } from '../redux/slices/filterSlice';\r\nimport { RootState, useAppDispatch } from '../redux/store';\r\n\r\nconst Home: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const dispatch = useAppDispatch();\r\n  const isSearchUrl = React.useRef<boolean>(false);\r\n  const isFirstMounted = React.useRef<boolean>(false);\r\n\r\n  const { categoryValue, sortValue, searchValue, currentPage } = useSelector(\r\n    (state: RootState) => state.filter,\r\n  );\r\n  const { itemsList, status } = useSelector(selectItemsList);\r\n\r\n  const fetching = async () => {\r\n    const sortValues: string[] = [\r\n      'rating',\r\n      'price&order=asc',\r\n      'price&order=desc',\r\n      'name&order=asc',\r\n      'name&order=desc',\r\n    ];\r\n    const category: string = categoryValue === 0 ? '' : `&category=${categoryValue}`;\r\n    const sort: string = `&sortBy=${sortValues[sortValue]}`;\r\n    const search: string = searchValue ? `&search=${searchValue}` : '';\r\n    const filters: string = sort + category + search;\r\n\r\n    dispatch(fetchItems({ filters, currentPage }));\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n\r\n    fetching();\r\n\r\n    isSearchUrl.current = false;\r\n  }, [categoryValue, sortValue, searchValue, currentPage, window.location.search]);\r\n\r\n  // React.useEffect(() => {\r\n  //   if (window.location.search) {\r\n  //     const params = (qs.parse(window.location.search.substring(1)) as unknown) as FilterSliceType;\r\n\r\n  //     dispatch(setFilters({ ...params }));\r\n\r\n  //     isSearchUrl.current = true;\r\n  //   }\r\n  // }, []);\r\n\r\n  // React.useEffect(() => {\r\n  //   if (isFirstMounted.current) {\r\n  //     const queryString: string = qs.stringify({\r\n  //       categoryValue,\r\n  //       sortValue,\r\n  //       currentPage,\r\n  //     });\r\n\r\n  //     navigate(`?${queryString}`);\r\n  //   } else {\r\n  //     navigate('/');\r\n  //     isFirstMounted.current = true;\r\n  //   }\r\n  // }, [categoryValue, sortValue, currentPage]);\r\n\r\n  const pizzas = itemsList.map((obj) => <PizzaBlock key={obj.id} {...obj} />);\r\n  const skeleton = [...Array(4)].map(() => <Skeleton key={uniqid()} />);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"content__top\">\r\n        <Categories />\r\n        <Sort value={sortValue}/>\r\n      </div>\r\n      <h2 className=\"content__title\">Усі піци</h2>\r\n\r\n      {status === 'error' ? (\r\n        <ErrorGetItems />\r\n      ) : (\r\n        <div className=\"content__items\">{status !== 'success' ? skeleton : pizzas}</div>\r\n      )}\r\n      {itemsList.length > 0 && <Pagination />}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}